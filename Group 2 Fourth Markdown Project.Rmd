---
title: "Group 2 Fourth Markdown Project"
author: "Raphael Lee, Javier Bolong, Allen Abel, Tricia Pulmano"
date: "`r Sys.Date()`"
output:
  tufte::tufte_html: default
  tufte::tufte_handout:
    citation_package: natbib
    latex_engine: xelatex
  tufte::tufte_book:
    citation_package: natbib
    latex_engine: xelatex
link-citations: yes
---

```{r setup, include=FALSE}
library(tufte)
# invalidate cache when the tufte version changes
knitr::opts_chunk$set(cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)
```
## Introduction


## Methodology


## Parameters of Interest


## Simple Linear Regression
<br>



> ### A. Geting the Linear Regression

We can use the Formula for linear regression model:
\[
  Y=\beta_0+\beta_1x_1+\beta_2x_2+\epsilon
\]

Before we can use that equation, we need to use the least square equation to get the value of $\hat{\beta_0},\hat{\beta_1}$ and $\hat{\beta_2}$ which is represented by:



$$n{\hat{\beta}}_0 + {\hat{\beta}}_1\sum_{i=1}^{n}x_{i1}+ {\hat{\beta}}_2\sum_{i=1}^{n}x_{i2}= \sum_{i=1}^{n}y_{i}$$
$${\hat{\beta}}_0\sum_{i=1}^{n}x_{i1} + {\hat{\beta}}_1\sum_{i=1}^{n}x_{i1}^2+ {\hat{\beta}}_2\sum_{i=1}^{n}x_{i1}x_{i2}= \sum_{i=1}^{n}x_{i1}y_{i}$$

$${\hat{\beta}}_0\sum_{i=1}^{n}x_{i2} + {\hat{\beta}}_1\sum_{i=1}^{n}x_{i1}x_{i2}+ {\hat{\beta}}_2\sum_{i=1}^{n}x_{i2}^2 = \sum_{i=1}^{n}x_{i2}y_{i}$$

We can just use R to solve for this

``` {r}
Grade <- c(6,7,8,9,10,11,12)
Fun <- c(94813.08411,202473.1183,248076.9231,316880,297539.6825,420340.9091,511129.0323)
Rumor <- c(114632.7684,291937.9845,295419.8473,373679.2453,290620.155,362647.0588,293425.9259)
summaries1 <- lm(Grade ~ Fun + Rumor)
summary(summaries1)
```
Using R, we see that the values of $\hat{\beta_0},\hat{\beta_1}$ and $\hat{\beta_2}$ which are:
$\hat{\beta_0}=4.681e+00$,

$\hat{\beta_1}=1.585e-05$,

$\hat{\beta_2}=-1.438e-06$

Finally after subtituting, the linear regression equation would:
\begin{align}
&y=4.681e+00+1.585e-05x_1--1.438e-06x_2
\end{align}

<br>
<br>

> ### B. Estimating σ2.

<br>
To estimate $σ^2$, we can use the following formula:
\[
  σ^2=\frac{SS_E}{n-p}
\]

But we could just use R again to calculate it for use. Thus using the following code:

``` {r}
Grade <- c(6,7,8,9,10,11,12)
Fun <- c(94813.08411,202473.1183,248076.9231,316880,297539.6825,420340.9091,511129.0323)
Rumor <- c(114632.7684,291937.9845,295419.8473,373679.2453,290620.155,362647.0588,293425.9259)
summaries2 <- lm(Grade ~ Fun + Rumor)
anova(summaries2)
```

Looking at the summary we could see that $σ^2$ is estimated to be 0.3721.

<br>
<br>

> ### C. Computing for the standard errors of the regression coefficients.

<br>
To compute for the standard errors of the regression coefficients we can use the equation:
\[
  se(\beta_j)=\sqrt{\sigma^2C_{jj}}\\
\]
Where $C_{jj}=(X'X)^{-1}.$

Using the data from the table we can construct $X$ and $X'$ which is represented by these table respectively:

``` {r X and X, include=TRUE, echo=FALSE}
xvalues <- c(1,94813.08411,114632.7684,1,202473.1183,291937.9845,1,248076.9231,295419.8473,1,316880,373679.245283019,1,297539.682539683,290620.155,1,420340.9091,362647.0588,1,511129.0323,293425.9259) 
x <- matrix(xvalues,nrow=7,ncol=3,byrow=TRUE)
x
t(x) 
xtrans <- t(x)
```


Then we can compute for $X'X$

``` {r XX, include=TRUE, echo=FALSE}
xvalues <- c(1,94813.08411,114632.7684,1,202473.1183,291937.9845,1,248076.9231,295419.8473,1,316880,373679.245283019,1,297539.682539683,290620.155,1,420340.9091,362647.0588,1,511129.0323,293425.9259) 
x <- matrix(xvalues,nrow=7,ncol=3,byrow=TRUE)
xtrans <- t(x)
xx <- (xtrans %*% x)
xx
```

With $X'X$ computed we can now look for its inverse $(X'X)^{-1}$:

``` {r inverse, include=TRUE, echo=FALSE}
xvalues <- c(1,94813.08411,114632.7684,1,202473.1183,291937.9845,1,248076.9231,295419.8473,1,316880,373679.245283019,1,297539.682539683,290620.155,1,420340.9091,362647.0588,1,511129.0323,293425.9259) 
x <- matrix(xvalues,nrow=7,ncol=3,byrow=TRUE)
xxinv <- solve(xx)
xxinv
```

The variances of the regression coefficients are given by the diagonal elements thus  $C_{00}$ is 2.083207e+00, $C_{11}$ is 1.569781e-11, and $C_{22}$ is 4.142065e-11 and now we can solve $se(\beta_0)$,$se(\beta_1)$ and $se(\beta_2)$:
\[
\begin{align} 
&se(\beta_0)=\sqrt{0.3721(2.083207e+00)}=8.805e-01\\
&se(\beta_1)=\sqrt{0.3721(1.569781e-11)}=2.417e-06\\
&se(\beta_2)=\sqrt{0.3721(4.142065e-11)}=3.926e-06\\
\end{align}
\]

We can also see these numbers in the summary table we did earlier

``` {r}
Grade <- c(6,7,8,9,10,11,12)
Fun <- c(94813.08411,202473.1183,248076.9231,316880,297539.6825,420340.9091,511129.0323)
Rumor <- c(114632.7684,291937.9845,295419.8473,373679.2453,290620.155,362647.0588,293425.9259)
summaries1 <- lm(Grade ~ Fun + Rumor)
summary(summaries1)
```

<br>
<br>


The Hypothesis for these are:

$H_0$:$\beta_1=\beta_2=0$


$H_1$:$\beta_j≠0$ for at least one j

While the equation need is :

$F_0=\frac{\frac{SS_r}{k}}{\frac{SS_E}{n-p}}=\frac{MS_r}{MS_e}$

To Find $SS_R$, we must first find $SS_T$ as $SS_R=SS_T-SS_E$

We can use this equation to fine SS_T:

\[
  SS_T=y'y-(\frac{(\sum{y_I}1)^2}{n})    
\]

we can use R to find $y'y$
``` {r YY, include=TRUE, echo=FALSE}
library(knitr)
y.data <- c(6,7,8,9,10,11,12
            ) 
y <- matrix(y.data,nrow=7,ncol=1,byrow=TRUE)
yp <- t(y)
ypy <- (yp %*% y)
ypy
```
$(\sum{y_I}1)^2)$ can be solve:
$(\sum{y_I}1)^2=(6+7+8+9+10+11+12)^2=3969$

Substituting the value we can now solve for $SS_T$ as well and $SS_R$
\[
\begin{align} 
  SS_T&=595-(\frac{(3969)^2}{7})\\
  &=32446
  \end{align} 
\]
Given that $SS_E$ is equal to 1.4886 (See SummarIES2 )
\[
\begin{align} 
  SS_R&=32446-7927.6\\
  &=24518
  \end{align} 
\]

Finally we can geT the value of $F_0$

$F_0=\frac{\frac{SS_r}{k}}{\frac{SS_E}{n-p}}=\frac{MS_r}{MS_e}$
\[
\begin{align} 
  \end{align} 
\]
## Discussion


## Conclusion

